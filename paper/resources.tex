\section{Censorship by Resource Record Types} \label{sec:resources}

\para{Overview.}
In this section, we focus on {\it identifying and characterizing differences in
the handling of IPv4 and IPv6 resource records} in DNS censorship deployments.
Specifically, we seek to answer the following questions: 
%
(\Cref{sec:resources:sig}) is the censorship of IPv4 resource records (DNS
{\tt A} queries) significantly different than the censorship of IPv6 resource
records (DNS {\tt AAAA} queries)?,
%
(\Cref{sec:resources:domains}) what are the characteristics of domains in which
these differences are frequently observed?, and
%
(\Cref{sec:resources:resolvers}) what are the characteristics of the resolvers
which frequently exhibit such differences?

\subsection{Quantifying differences in the censorship of \texttt{A} and
\texttt{AAAA} resource records} \label{sec:resources:sig}
%
We use the responses received from our {\tt A} and {\tt AAAA} queries sent to
the same set of resolvers and for the same set of domains (\cf
\Cref{sec:methods:gathering} for a detailed description of our data gathering
process). We then apply the censorship determination methods described in
\Cref{sec:methods:labeling} to measure the prevalence of censorship on our {\tt
A} and {\tt AAAA} DNS queries. Finally, we perform statistical tests to
identify significant differences within a country, resolver, and domain. 

\begin{itemize}
  \item {\it Identifying differences within a country.} To measure differences
    in DNS query handling within a specific country, we compare the prevalence
    of censorship on {\tt A} and {\tt AAAA} queries by aggregating responses
    across {each resolver within the country}. This presents us with a two
    distributions (one each for the group of {\tt A} and {\tt AAAA} queries) of
    the fraction of censored domains observed from resolvers in the country.
    %
    We use a $t$-test to verify statistical significance of any observed
    differences between the two groups for each country. In our statistical
    analysis, we aim to achieve a significance level of 5\% ($p \leq$  .05)
    \emph{over all our findings}. Therefore, we apply a Bonferroni correction
    with $p \leq \frac{.05}{n_{c}}$, where $n_c$ is the total number of
    countries in our dataset (\fixme{XXX}). This conservative approach reduces
    the likelihood of false-positive reports of within-country differences.
    %
    The presence of a statistically significant difference for a specific
    country would imply that the two resource types appear to undergo different
    censorship mechanisms within that country (or, a significant number of
    resolvers within that country have inconsistencies in their handling of
    each query type).

  \item {\it Identifying differences in individual resolvers.} To measure
    differences in DNS query handling of individual resolvers, we compare the
    ratios of censored responses observed from our {\tt A} and {\tt AAAA}
    queries {from each resolver}. 
    %
    We use a two-proportion $z$-test to verify the statistical significance of
    any observed difference in the ratios between the two groups for each
    resolver. Similar to our within-country analysis, we apply a Bonferroni
    correction with $p \leq \frac{.05}{n_r}$, where $n_r$ is the total number
    of resolvers in our dataset (\fixme{XXX}).
    %
    In the absence of significant within-country differences, the presence of
    a statistically significant difference for a resolver would imply that the
    two resource types appear to undergo different censorship mechanisms due to
    resolver misconfiguration.

  \item {\it Identifying differences in domain behaviors within a country.} In
    this analysis, we compare the prevalence of censorship on the {\tt A} and
    {\tt AAAA} query by aggregating responses {for each (domain, country)
    pair in our study}.
    %
    We use a $t$-test to verify the statistical significance of any observed
    differences between the two query types for each domain tested within each
    country. We once again apply a Bonferroni correction to ensure that our
    results for domains identified to behave differently within each country
    are within a 5\% significance level. We set $p \leq
    \frac{.05}{n_{dom_{c}}}$, where $n_{dom_{c}}$ represents the number of
    domains tested in country $c$.
    %
    A statistically significant difference for a domain would suggest
    the presence of a domain-specific characteristic that results in the two
    resource records undergoing different censorship mechanisms within the
    corresponding country.
\end{itemize}


